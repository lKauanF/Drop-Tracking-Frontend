<div class="layout">
  <main class="conteudo">
    <header class="topbar">
      <div class="title-row">
        <h2 class="title">Pacientes</h2>
        <button
          type="button"
          class="btn-plus"
          (click)="abrirDialogAdicionar()"
          aria-label="Adicionar paciente">
          <mat-icon>add</mat-icon>
        </button>
      </div>

      <span class="totais">{{ total() }} Pacientes</span>
    </header>

    <div class="hairline"></div>

    <!-- Filtros -->
    <section class="filtros">
      <!-- BUSCA: sem mat-label e sem floatLabel -->
      <mat-form-field appearance="outline" class="campo busca slim">
        <mat-icon matPrefix>search</mat-icon>
        <input
          matInput
          placeholder="Buscar"
          [formControl]="filtros.controls.busca" />
      </mat-form-field>

      <!-- SITUAÇÃO: manter o label, usar floatLabel="always" -->
      <mat-form-field
        appearance="outline"
        class="campo selecao slim"
        floatLabel="always">
        <mat-label>Situação</mat-label>
        <mat-select [formControl]="filtros.controls.situacao">
          <mat-option value="">Situação atual</mat-option>
          <mat-option value="em_andamento">Em andamento</mat-option>
          <mat-option value="pausada">Pausada</mat-option>
        </mat-select>
      </mat-form-field>
    </section>

    <div class="hairline thin"></div>

    <!-- Grid de cards -->
    <section class="grid">
      <ng-container *ngIf="!carregando(); else carregandoTpl">
        <app-cartao-paciente
          *ngFor="let p of pacientes()"
          [paciente]="p">
        </app-cartao-paciente>

        <div *ngIf="pacientes().length === 0" class="vazio">
          Nenhum paciente encontrado.
        </div>
      </ng-container>

      <ng-template #carregandoTpl>
        <div class="vazio">Carregando...</div>
      </ng-template>
    </section>

    <!-- Paginação -->
    <footer class="paginacao" *ngIf="paginas().length > 1">
      <button mat-icon-button (click)="irPara(paginaAtual() - 1)" [disabled]="paginaAtual()===1">
        <mat-icon>chevron_left</mat-icon>
      </button>

      <button
        mat-stroked-button
        *ngFor="let n of paginas()"
        [class.atual]="n===paginaAtual()"
        (click)="irPara(n)">
        {{ n }}
      </button>

      <button mat-icon-button (click)="irPara(paginaAtual() + 1)" [disabled]="paginaAtual()===paginas().length">
        <mat-icon>chevron_right</mat-icon>
      </button>
    </footer>
  </main>
</div>
