<main class="login" role="main">
  <section class="login__container" aria-labelledby="loginTitle">
    <!-- Marca -->
    <header class="brand" aria-label="Drop Tracking">
      <img class="brand__logo" src="../../../../assets/Logo.svg" alt="" />
      <h1 id="loginTitle" class="brand__name">Drop Tracking</h1>
    </header>

    <!-- Card -->
    <div class="card">
      <!-- CPF (único) -->
      <div class="field">
        <label class="sr-only" for="cpf">CPF</label>
        <input
          id="cpf"
          type="text"
          inputmode="numeric"
          autocomplete="username"
          placeholder="CPF:"
          maxlength="14"
          [value]="cpfMascara"
          (input)="onCpfInput($event)"
          (keydown)="filtrarTeclas($event)"
          (paste)="onCpfPaste($event)"
          (blur)="cpfTouched = true"
        />

        <!-- Erro: incompleto -->
        <div class="error" *ngIf="cpfTouched && !cpfCompleto">
          CPF deve ter 11 números.
        </div>
        <!-- Erro: inválido (algoritmo) -->
        <div class="error" *ngIf="cpfTouched && cpfCompleto && !cpfValido">
          CPF inválido.
        </div>
      </div>

      <!-- Senha -->
      <div class="field">
        <label class="sr-only" for="senha">Senha</label>
        <div class="password-wrapper">
          <input
            id="senha"
            [type]="showPassword ? 'text' : 'password'"
            autocomplete="current-password"
            placeholder="Senha:"
            [value]="senha"
            (input)="onSenhaInput($event)"
            (blur)="senhaTouched = true"
          />
          <button
            class="toggle-eye"
            type="button"
            (click)="toggleShowPassword()"
            [attr.aria-label]="showPassword ? 'Ocultar senha' : 'Mostrar senha'"
            title="{{ showPassword ? 'Ocultar senha' : 'Mostrar senha' }}"
          >
            <ng-container *ngIf="!showPassword">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                   fill="none" stroke="#6b7a80" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8Z"/>
                <circle cx="12" cy="12" r="3"/>
              </svg>
            </ng-container>
            <ng-container *ngIf="showPassword">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                   fill="none" stroke="#6b7a80" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M17.94 17.94A10.94 10.94 0 0 1 12 20C5 20 1 12 1 12a21.77 21.77 0 0 1 5.06-6.94"/>
                <path d="M10.58 10.58a2 2 0 1 0 2.83 2.83"/>
                <path d="M1 1l22 22"/>
              </svg>
            </ng-container>
          </button>
        </div>
      </div>

      <!-- Ações -->
      <div class="actions">
        <button class="btn btn-primary" type="button" (click)="onSubmit()">Entrar</button>
        <a class="btn btn-ghost" routerLink="/cadastro">Cadastrar</a>
      </div>

      <!-- Erro geral -->
      <div class="auth-error" *ngIf="authError">{{ authError }}</div>
    </div>

    <!-- Link fora do card -->
    <div class="forgot">
      <a routerLink="/recuperar-senha">Esqueceu a <span class="accent">senha</span>?</a>
    </div>
  </section>
</main>
